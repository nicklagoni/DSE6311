"0","clean_data_percent<-clean_data%>%"
"0","  mutate(across(all_of(percent_cover_cols),~./100)) #converting to a 0 - 1 scale for logit transformation"
"0","logit_data<-clean_data_percent%>%"
"0","  mutate(across(all_of(percent_cover_cols),~qlogis(pmin(pmax(.,0.0001),1-0.0001)))) "
"0","#have to limit the range from 0.0001 to 0.9999 otherwise it gives me NaNs and -Inf values."
"0",""
"0","logit_skew_fuc<-skewness(logit_data$rockweed_fucus_spp)"
"0","logit_skew_asco<-skewness(logit_data$knotted_wrack_a_nodosum)"
"0","skew_fuc<-skewness(clean_data$rockweed_fucus_spp)"
"0","skew_asco<-skewness(clean_data$knotted_wrack_a_nodosum)"
"0",""
"0",""
"0","logit_data_lag <- logit_data %>%"
"0","  arrange(plot_id, start_date) %>%"
"0","  group_by(plot_id) %>%"
"0","  mutate(across(all_of(percent_cover_cols), "
"0","                ~ dplyr::lag(., n = 1), "
"0","                .names = ""lag1_{col}"")) %>%"
"0","  ungroup()"
"0",""
"0","# Keep only rows where lag exists; drop first year per site"
"0","logit_data_lag <- logit_data_lag %>%"
"0","  filter(!is.na(lag1_rockweed_fucus_spp))"
"0",""
"0","# Ascophyllum lagged predictors"
"0","asco_predictors <- grep(""^lag1_"", names(logit_data_lag), value = TRUE)"
"0","formula_asco <- as.formula("
"0","  paste(""knotted_wrack_a_nodosum ~"", paste(asco_predictors, collapse = "" + ""))"
"0",")"
"0","# Fucus lagged predictors"
"0","fuc_predictors <- grep(""^lag1_"", names(logit_data_lag), value = TRUE)"
"0","formula_fuc <- as.formula("
"0","  paste(""rockweed_fucus_spp ~"", paste(fuc_predictors, collapse = "" + ""))"
"0",")"
"0",""
"0","oob_asco <- randomForest(formula_asco, data = logit_data_lag, ntree = 500, importance = TRUE)"
"0","oob_fuc  <- randomForest(formula_fuc,  data = logit_data_lag, ntree = 500, importance = TRUE)"
"0",""
"0","print(oob_asco)"
"1","
Call:
"
"1"," "
"1","randomForest(formula = formula_asco, data = logit_data_lag, ntree = 500, "
"1"," "
"1","    importance = TRUE)"
"1"," "
"1","
"
"1","               Type of random forest: "
"1",""
"1","regression"
"1",""
"1","
"
"1","                     Number of trees: "
"1",""
"1","500"
"1",""
"1","
"
"1","No. of variables tried at each split: "
"1",""
"1","8"
"1",""
"1","

"
"1","          Mean of squared residuals: "
"1",""
"1","2.814435"
"1",""
"1","
"
"1","                    % Var explained: "
"1",""
"1","87.41"
"1",""
"1","
"
"0","print(oob_fuc)"
"1","
Call:
"
"1"," "
"1","randomForest(formula = formula_fuc, data = logit_data_lag, ntree = 500, "
"1"," "
"1","    importance = TRUE)"
"1"," "
"1","
"
"1","               Type of random forest: "
"1",""
"1","regression"
"1",""
"1","
"
"1","                     Number of trees: "
"1",""
"1","500"
"1",""
"1","
"
"1","No. of variables tried at each split: "
"1",""
"1","8"
"1",""
"1","

"
"1","          Mean of squared residuals: "
"1",""
"1","6.963575"
"1",""
"1","
"
"1","                    % Var explained: "
"1",""
"1","72.61"
"1",""
"1","
"
"0","# Example OOB plot"
"0","plot(oob_asco$predicted, logit_data_lag$knotted_wrack_a_nodosum,"
"0","     xlab = ""OOB Predicted"", ylab = ""Actual"","
"0","     main = ""Logit Transformed OOB Predicted vs Actual"")"
